### 多元函数求极值的数学方法

![image-20250112153628494](assets\image-20250112153628494.png)

在学习机器学习算法时，经常需要讨论模型的目标函数，并求出使目标函数取得最小值时的自变量取值。不同算法的目标函数对应不同的多元函数。例如，在解决一元线性回归问题时，优化的目标函数 $E$ 是关于 $w$ 和 $b$ 的函数，需要求 $E$ 取得最小值时参数 $w$ 和 $b$ 的取值，这个问题可以通过求导法解决。

#### 一、函数极值的概念

对于一般的二元函数 $z = f(x, y)$，设在点 $(x_0, y_0)$ 的某领域内有定义，对于该领域内不同于 $(x_0, y_0)$ 的点 $(x, y)$：

- 如果满足不等式 $f(x, y) < f(x_0, y_0)$，则称函数在 $(x_0, y_0)$ 处有**极大值**。
- 如果满足不等式 $f(x, y) > f(x_0, y_0)$，则称函数在 $(x_0, y_0)$ 处有**极小值**。

**极大值**和**极小值**统称为**极值**，使函数取得极值的点称为**极值点**。极值点不一定是最值点，函数也可能没有极值点。

示例：

1. 函数 $z_1 = 3x^2 + 4y^2$ 在 $(0, 0)$ 处有极小值。
2. 函数 $z_2 = -3x^2 - 4y^2$ 在 $(0, 0)$ 处有极大值。
3. 函数 $z = xy$ 在 $(0, 0)$ 处没有极值。

#### 二、求极值的必要条件——定理一

![image-20250112153702417](assets\image-20250112153702417.png)

**定理一**：设函数 $z = f(x, y)$ 在点 $(x_0, y_0)$ 处存在偏导数且有极值，则该点的偏导数为 0，即 $\frac{\partial f}{\partial x}(x_0, y_0) = 0$ 和 $\frac{\partial f}{\partial y}(x_0, y_0) = 0$。

使一阶偏导数同时为零的点称为**驻点**。在偏导数存在的情况下，极值点一定是驻点，但驻点不一定是极值点。

示例：对于函数 $z = xy$，其偏导数为 $\frac{\partial f}{\partial x} = y$，$\frac{\partial f}{\partial y} = x$。联立方程可得 $(0, 0)$ 是驻点，但从图像观察可知 $(0, 0)$ 并不是极值点。

![image-20250112153759979](assets\image-20250112153759979.png)

#### 三、判别驻点是否为极值点——定理二

![image-20250112153857202](assets\image-20250112153857202.png)

**定理二**：设函数 $z = f(x, y)$ 在点 $(x_0, y_0)$ 的某领域内连续，并且具有一阶和二阶连续偏导数。

设 $f_x = \frac{\partial f}{\partial x}$ 为对 $x$ 的一阶偏导数，$f_y = \frac{\partial f}{\partial y}$ 为对 $y$ 的一阶偏导数，$f_{xx} = \frac{\partial^2 f}{\partial x^2}$ 为二阶偏导数，$f_{xy} = \frac{\partial^2 f}{\partial x \partial y}$ 为混合二阶偏导数，$f_{yy} = \frac{\partial^2 f}{\partial y^2}$ 为二阶偏导数。

计算判别式 $D = f_{xx}(x_0, y_0) \cdot f_{yy}(x_0, y_0) - \left( f_{xy}(x_0, y_0) \right)^2$。

![image-20250112153952745](assets\image-20250112153952745.png)

根据 $D$ 的值判断驻点性质：

- 若 $D > 0$ 且 $f_{xx}(x_0, y_0) < 0$，则 $(x_0, y_0)$ 为极大值点。
- 若 $D > 0$ 且 $f_{xx}(x_0, y_0) > 0$，则 $(x_0, y_0)$ 为极小值点。
- 若 $D < 0$，则 $(x_0, y_0)$ 不是极值点。
- 若 $D = 0$，需要进一步讨论。

#### 四、求解步骤

![image-20250112154122115](assets\image-20250112154122115.png)

求解二元函数 $z = f(x, y)$ 极值点的一般步骤：

1. **求偏导数**：计算 $f_x$ 和 $f_y$ 并令其等于 0，解方程得到所有驻点。
2. **计算二阶偏导数**：对每个驻点计算 $f_{xx}$、$f_{xy}$ 和 $f_{yy}$ 并带入计算 $D$。
3. **判断极值点类型**：根据 $D$ 和 $f_{xx}$ 的符号确定是极大值点、极小值点，还是非极值点。

#### 五、扩展到多元函数

![image-20250112154155204](assets\image-20250112154155204.png)

对于 $n$ 元函数 $u = f(x_1, x_2, \ldots, x_n)$，求极值的步骤类似：

1. 计算关于 $x_1, x_2, \ldots, x_n$ 的偏导数并联立求驻点。
2. 判断驻点是否为极值点。

示例：对于三元函数 $u = f(x, y, z)$，需计算 $\frac{\partial u}{\partial x}$、$\frac{\partial u}{\partial y}$ 和 $\frac{\partial u}{\partial z}$ 并联立方程得到驻点 $(x_0, y_0, z_0)$，再根据二阶偏导数判断。

#### 六、示例题

![image-20250112154233287](assets\image-20250112154233287.png)

**例子**：求函数 $f(x, y) = 3x^2 + 4y^2 - 5$ 的极值。

1. **求偏导数**：$f_x = 6x$，$f_y = 8y$。令 $f_x = 0$，$f_y = 0$，解得驻点 $(0, 0)$。
2. **计算二阶偏导数**：$f_{xx} = 6$，$f_{xy} = 0$，$f_{yy} = 8$。
3. **计算判别式 $D$**：$D = 6 \times 8 - 0^2 = 48 > 0$。

由于 $f_{xx} = 6 > 0$，所以 $(0, 0)$ 是极小值点。

![image-20250112154304129](assets\image-20250112154304129.png)

通过上述方法，可以求解多元函数的极值问题