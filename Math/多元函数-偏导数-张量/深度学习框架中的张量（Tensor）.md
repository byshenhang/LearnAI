![image-20250112180640378](assets\image-20250112180640378.png)



![image-20250112180741939](assets\image-20250112180741939.png)

# 深度学习框架中的张量（Tensor）详解

## 1. 课程简介

大家好！今天我们将深入探讨在深度学习框架 **PyTorch** 中张量（Tensor）的程序设计实验。张量是PyTorch以及其他深度学习框架中最基本也是最重要的数据结构。通过本次课程，你将全面了解张量的概念、创建方法及其常用接口。

------

## 2. 张量（Tensor）概述

### 2.1 什么是张量？

从使用者的角度来看，张量可以简单地理解为标量、向量或矩阵的泛化。张量是一个支持高效科学计算的多维数组。

- **标量（Scalar）**：仅包含一个数字的张量，称为零维张量。例如，数字 `1` 是一个零维张量。
- **向量（Vector）**：由多个数字组成的一维数组，称为一维张量。包含一个轴。
- **矩阵（Matrix）**：由向量组成的二维数组，称为二维张量。包含两个轴，通常称为行和列。
- **三维张量**：由多个矩阵组成的三维数组，包含三个轴，可以直观地理解为数字组成的立方体。
- **高维张量**：通过扩展上述方法，可以创建四维、五维甚至更高维度的张量。例如，四维张量可以看作由多个立方体组成的数组。

### 2.2 张量的应用

张量是深度学习模型中数据传输和计算的基本单元。它们在训练和推理过程中承载着输入数据、模型参数及中间计算结果。

------

## 3. 张量的创建方法

在PyTorch中，创建张量有多种方式，主要包括：

1. **根据指定的形状创建张量**
2. **根据列表（List）数据创建张量**
3. **基于已有张量创建新的张量**

### 3.1 根据指定形状创建张量

使用 `torch.empty()`, `torch.zeros()`, `torch.ones()` 等函数可以根据指定的形状创建张量。

```python
import torch

# 创建一个形状为 (2, 3) 的空张量
a = torch.empty(2, 3)
print("空张量 a:\n", a)
```

**模拟输出：**

```
空张量 a:
 tensor([[1.0410e-37, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00]])
```

### 3.2 根据列表数据创建张量

可以通过传入列表（List）或嵌套列表来创建张量。

```python
# 根据列表创建张量 b
b = torch.tensor([[1, 2, 3], [4, 5, 6]])
print("张量 b:\n", b)
```

**模拟输出：**

```
张量 b:
 tensor([[1, 2, 3],
        [4, 5, 6]])
```

### 3.3 基于已有张量创建新张量

可以通过已有张量来创建新的张量，例如复制张量或改变其形状。

```python
# 基于张量 b 创建新张量 c
c = b.clone()
print("张量 c（复制自 b）:\n", c)
```

**模拟输出：**

```
张量 c（复制自 b）:
 tensor([[1, 2, 3],
        [4, 5, 6]])
```

------

## 4. PyTorch 中张量的创建示例

我们将使用 **Jupyter Notebook** 来演示在PyTorch中创建张量的具体方法。

### 4.1 导入PyTorch并检查版本

```python
import torch

# 打印当前PyTorch的版本
print("PyTorch版本:", torch.__version__)
```

**模拟输出：**

```
PyTorch版本: 1.13.1
```

### 4.2 使用 `torch.Tensor` 创建张量

![image-20250112181055205](assets\image-20250112181055205.png)

```python
# 使用 torch.Tensor 创建一个 2x3 的张量 a
a = torch.Tensor(2, 3)
print("张量 a:\n", a)
```

**模拟输出：**

```
张量 a:
 tensor([[1.4013e-45, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00]])
```

### 4.3 使用 `torch.tensor` 创建张量

```python
# 使用 torch.tensor 根据列表创建张量 b
b = torch.tensor([[1, 2, 3], [4, 5, 6]])
print("张量 b:\n", b)
```

**模拟输出：**

```
张量 b:
 tensor([[1, 2, 3],
        [4, 5, 6]])
```

### 4.4 张量转换与输出

```python
# 将张量 b 转换为列表并保存到 c 中
c = b.tolist()
print("列表 c:", c)

# 使用 torch.randn 创建一个 3x3 的张量 d
d = torch.randn(3, 3)
print("张量 d:\n", d)

# 使用 torch.tensor 创建张量 e
e = torch.tensor([[7, 8, 9], [10, 11, 12]])
print("张量 e:\n", e)
```

**模拟输出：**

```
列表 c: [[1, 2, 3], [4, 5, 6]]
张量 d:
 tensor([[ 0.4963, -0.1383,  0.6475],
        [ 1.2370, -0.7023, -0.3826],
        [ 0.9472,  0.1771, -0.4312]])
张量 e:
 tensor([[ 7,  8,  9],
        [10, 11, 12]])
```

------

## 5. 大小写敏感的 `tensor` 创建函数

PyTorch中有两个类似的函数用于创建张量：`torch.Tensor` 和 `torch.tensor`。它们的区别如下：

### 5.1 `torch.Tensor`（大写 T）

- **类型**：类构造函数。
- **默认类型**：单精度浮点类型（`torch.float32`）。
- **用法**：`torch.Tensor(*size)` 创建未初始化的张量，类型为浮点数。

```python
a = torch.Tensor([[1, 2], [3, 4]])
print("a 的类型:", type(a))
print("a 的数据类型:", a.dtype)
```

**模拟输出：**

```
a 的类型: <class 'torch.Tensor'>
a 的数据类型: torch.float32
```

### 5.2 `torch.tensor`（小写 t）

- **类型**：函数。
- **功能**：根据传入的数据类型自动推断张量的数据类型。
- **用法**：`torch.tensor(data)` 创建一个新张量，数据类型根据 `data` 自动决定。

```python
b = torch.tensor([[1, 2], [3, 4]])
print("b 的类型:", type(b))
print("b 的数据类型:", b.dtype)
```

**模拟输出：**

```
b 的类型: <class 'torch.Tensor'>
b 的数据类型: torch.int64
```

### 5.3 区别总结

- **`torch.Tensor`** 默认创建的是浮点类型张量，不初始化数据。
- **`torch.tensor`** 根据输入数据类型自动推断，如传入整数列表则创建整型张量。

------

## 6. 常用张量接口

PyTorch提供了丰富的接口用于创建和操作张量。以下是一些常用的张量创建函数及其用法：

### 6.1 查看张量的形状

使用 `tensor.size()` 或 `tensor.shape` 查看张量的形状。

```python
# 创建一个 2x3 的张量
a = torch.tensor([[1, 2, 3], [4, 5, 6]])
print("张量 a 的形状:", a.size())
```

**模拟输出：**

```
张量 a 的形状: torch.Size([2, 3])
```

### 6.2 创建值为一的张量

使用 `torch.ones()` 创建指定形状且所有元素为1的张量。

```python
ones_tensor = torch.ones(3, 4)
print("值为一的张量:\n", ones_tensor)
```

**模拟输出：**

```
值为一的张量:
 tensor([[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]])
```

### 6.3 创建值为零的张量

使用 `torch.zeros()` 创建指定形状且所有元素为0的张量。

```python
zeros_tensor = torch.zeros(2, 5)
print("值为零的张量:\n", zeros_tensor)
```

**模拟输出：**

```
值为零的张量:
 tensor([[0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0.]])
```

### 6.4 创建标准正态分布的随机数张量

使用 `torch.randn()` 创建服从标准正态分布的随机数张量。

```python
randn_tensor = torch.randn(4, 2)
print("标准正态分布的随机数张量:\n", randn_tensor)
```

**模拟输出：**

```
标准正态分布的随机数张量:
 tensor([[ 0.4963, -0.1383],
        [ 0.6475,  1.2370],
        [-0.7023, -0.3826],
        [ 0.9472,  0.1771]])
```

### 6.5 创建均匀分布的数据张量

使用 `torch.linspace()` 创建在指定区间内均匀分布的数据张量。

```python
linspace_tensor = torch.linspace(0, 1, steps=5)
print("均匀分布的数据张量:", linspace_tensor)
```

**模拟输出：**

```
均匀分布的数据张量: tensor([0.0000, 0.2500, 0.5000, 0.7500, 1.0000])
```

------

## 7. 示例代码汇总

以下是一个完整的示例，涵盖了上述内容的实践应用。

```python
import torch

# 1. 导入PyTorch并检查版本
print("PyTorch版本:", torch.__version__)

# 2. 使用 torch.Tensor 创建张量 a
a = torch.Tensor(2, 3)
print("张量 a:\n", a)

# 3. 使用 torch.tensor 创建张量 b
b = torch.tensor([[1, 2, 3], [4, 5, 6]])
print("张量 b:\n", b)

# 4. 将张量 b 转换为列表 c
c = b.tolist()
print("列表 c:", c)

# 5. 使用 torch.randn 创建张量 d
d = torch.randn(3, 3)
print("张量 d:\n", d)

# 6. 使用 torch.tensor 创建张量 e
e = torch.tensor([[7, 8, 9], [10, 11, 12]])
print("张量 e:\n", e)

# 7. 创建值为一的张量
ones_tensor = torch.ones(3, 4)
print("值为一的张量:\n", ones_tensor)

# 8. 创建值为零的张量
zeros_tensor = torch.zeros(2, 5)
print("值为零的张量:\n", zeros_tensor)

# 9. 创建标准正态分布的随机数张量
randn_tensor = torch.randn(4, 2)
print("标准正态分布的随机数张量:\n", randn_tensor)

# 10. 创建均匀分布的数据张量
linspace_tensor = torch.linspace(0, 1, steps=5)
print("均匀分布的数据张量:", linspace_tensor)

# 11. 查看张量 a 的形状
print("张量 a 的形状:", a.size())

# 12. 查看张量 b 和 c 的类型和数据类型
print("b 的类型:", type(b))
print("b 的数据类型:", b.dtype)
print("c 的类型:", type(c))
```

**模拟输出：**

```
PyTorch版本: 1.13.1
张量 a:
 tensor([[1.4013e-45, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00]])
张量 b:
 tensor([[1, 2, 3],
        [4, 5, 6]])
列表 c: [[1, 2, 3], [4, 5, 6]]
张量 d:
 tensor([[ 0.4963, -0.1383,  0.6475],
        [ 1.2370, -0.7023, -0.3826],
        [ 0.9472,  0.1771, -0.4312]])
张量 e:
 tensor([[ 7,  8,  9],
        [10, 11, 12]])
值为一的张量:
 tensor([[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]])
值为零的张量:
 tensor([[0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0.]])
标准正态分布的随机数张量:
 tensor([[ 0.4963, -0.1383],
        [ 0.6475,  1.2370],
        [-0.7023, -0.3826],
        [ 0.9472,  0.1771]])
均匀分布的数据张量: tensor([0.0000, 0.2500, 0.5000, 0.7500, 1.0000])
张量 a 的形状: torch.Size([2, 3])
b 的类型: <class 'torch.Tensor'>
b 的数据类型: torch.int64
c 的类型: <class 'list'>
```

------

## 8. 结语

到此为止，我们详细介绍了PyTorch框架中张量（Tensor）的概念、创建方法及常用接口。掌握张量的使用是深入学习深度学习框架的基础。感谢大家的观看，我们下节课再会！